object Form_tabcvtcrdcon: TForm_tabcvtcrdcon
  Left = 258
  Top = 157
  Width = 696
  Height = 480
  Caption = 'Tabla de Costo de Ventas Tradicionales Credito/Contado '
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'MS Sans Serif'
  Font.Style = []
  FormStyle = fsMDIChild
  OldCreateOrder = False
  Position = poDefault
  Visible = True
  OnClose = FormClose
  OnCreate = FormCreate
  PixelsPerInch = 96
  TextHeight = 13
  object pnl_datos: TPanel
    Left = 0
    Top = 0
    Width = 688
    Height = 89
    Align = alTop
    BevelOuter = bvNone
    TabOrder = 0
    object Panel2: TPanel
      Left = 0
      Top = 0
      Width = 297
      Height = 89
      Align = alLeft
      BevelOuter = bvNone
      TabOrder = 0
      object Label1: TLabel
        Left = 5
        Top = 16
        Width = 60
        Height = 13
        Caption = 'Fecha Inicial'
      end
      object Label2: TLabel
        Left = 5
        Top = 40
        Width = 55
        Height = 13
        Caption = 'Fecha Final'
      end
      object date_fecini: TDateTimePicker
        Left = 77
        Top = 13
        Width = 97
        Height = 21
        CalAlignment = dtaLeft
        Date = 38981.5149197569
        Time = 38981.5149197569
        DateFormat = dfShort
        DateMode = dmComboBox
        Kind = dtkDate
        ParseInput = False
        TabOrder = 0
      end
      object date_fecfin: TDateTimePicker
        Left = 77
        Top = 37
        Width = 97
        Height = 21
        CalAlignment = dtaLeft
        Date = 38981.5149197569
        Time = 38981.5149197569
        DateFormat = dfShort
        DateMode = dmComboBox
        Kind = dtkDate
        ParseInput = False
        TabOrder = 1
      end
      object BitBtn1: TBitBtn
        Left = 197
        Top = 16
        Width = 75
        Height = 25
        TabOrder = 2
        OnClick = BitBtn1Click
        Kind = bkOK
      end
      object BitBtn2: TBitBtn
        Left = 200
        Top = 48
        Width = 75
        Height = 25
        Action = imprimir
        Caption = 'Imprimir'
        TabOrder = 3
        Glyph.Data = {
          36040000424D3604000000000000360000002800000010000000100000000100
          2000000000000004000000000000000000000000000000000000FF00FF000000
          0000000000000000000000000000000000000000000000000000000000000000
          00000000000000000000000000000000000000000000FF00FF0000000000BDBD
          BD00BDBDBD00BDBDBD00BDBDBD00BDBDBD00BDBDBD00BDBDBD00BDBDBD00BDBD
          BD00BDBDBD00BDBDBD00BDBDBD00BDBDBD00BDBDBD000000000000000000BDBD
          BD00BDBDBD00BDBDBD00BDBDBD00BDBDBD00BDBDBD00BDBDBD00BDBDBD00BDBD
          BD00BDBDBD00BDBDBD00BDBDBD00BDBDBD00BDBDBD0000000000000000000000
          0000000000000000000000000000000000000000000000000000000000000000
          000000000000000000000000000000000000000000000000000000000000FFFF
          FF00BDBDBD00FFFFFF00BDBDBD00FFFFFF00BDBDBD00FFFFFF00BDBDBD00FFFF
          FF00BDBDBD00FFFFFF00BDBDBD00FFFFFF00BDBDBD000000000000000000BDBD
          BD00FFFFFF00BDBDBD00FFFFFF00BDBDBD00FFFFFF00BDBDBD00FFFFFF00BDBD
          BD00FFFFFF00BDBDBD00FFFFFF000000FF00FFFFFF000000000000000000FFFF
          FF00BDBDBD00FFFFFF00BDBDBD00FFFFFF00BDBDBD00FFFFFF00BDBDBD00FFFF
          FF00BDBDBD00FFFFFF00BDBDBD00FFFFFF00BDBDBD0000000000000000000000
          0000000000000000000000000000000000000000000000000000000000000000
          0000000000000000000000000000000000000000000000000000FF00FF00FF00
          FF00FF00FF0000000000FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
          FF00FFFFFF00FFFFFF0000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00
          FF00FF00FF0000000000FFFFFF0000000000000000000000000000000000FFFF
          FF0000000000FFFFFF0000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00
          FF00FF00FF0000000000FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
          FF00FFFFFF00FFFFFF0000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00
          FF00FF00FF0000000000FFFFFF000000000000000000FFFFFF00000000000000
          0000000000000000000000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00
          FF00FF00FF0000000000FFFFFF00FFFFFF00FFFFFF00FFFFFF0000000000FFFF
          FF00FFFFFF0000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
          FF00FF00FF0000000000FFFFFF0000000000BDBDBD00FFFFFF0000000000FFFF
          FF0000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
          FF00FF00FF0000000000FFFFFF00FFFFFF00FFFFFF00FFFFFF00000000000000
          0000FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
          FF00FF00FF00000000000000000000000000000000000000000000000000FF00
          FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00}
      end
    end
    object Memo1: TMemo
      Left = 297
      Top = 0
      Width = 391
      Height = 89
      Align = alClient
      Lines.Strings = (
        'Memo1')
      TabOrder = 1
    end
  end
  object dbgrd_renglones: TdxDBGrid
    Left = 0
    Top = 89
    Width = 688
    Height = 357
    Bands = <
      item
      end>
    DefaultLayout = True
    HeaderPanelRowCount = 1
    KeyField = 'llave'
    ShowGroupPanel = True
    ShowSummaryFooter = True
    SummaryGroups = <>
    SummarySeparator = ', '
    Align = alClient
    PopupMenu = PopupMenu1
    TabOrder = 1
    DataSource = dts_analisma
    Filter.Active = True
    Filter.AutoDataSetFilter = True
    Filter.Criteria = {00000000}
    OptionsDB = [edgoCancelOnExit, edgoCanDelete, edgoCanInsert, edgoCanNavigation, edgoConfirmDelete, edgoLoadAllRecords, edgoUseBookmarks]
    OptionsView = [edgoBandHeaderWidth, edgoRowSelect, edgoUseBitmap]
    OnCustomDraw = dbgrd_renglonesCustomDraw
    object dbgrd_renglonesZONA: TdxDBGridMaskColumn
      Caption = 'Zona'
      Sorted = csUp
      Visible = False
      BandIndex = 0
      RowIndex = 0
      FieldName = 'zonaacum'
      GroupIndex = 0
    end
    object dbgrd_renglonesLINEA: TdxDBGridMaskColumn
      Caption = 'Linea'
      BandIndex = 0
      RowIndex = 0
      FieldName = 'LINEA'
    end
    object dbgrd_renglonesCODIGO: TdxDBGridMaskColumn
      Caption = 'Nombre Línea'
      BandIndex = 0
      RowIndex = 0
      FieldName = 'DESCRILIN'
    end
    object dbgrd_renglonesTOTCONT: TdxDBGridCurrencyColumn
      Caption = 'Total Contado'
      BandIndex = 0
      RowIndex = 0
      FieldName = 'totcont'
    end
    object dbgrd_renglonesTOTCRED: TdxDBGridCurrencyColumn
      Caption = 'Total Crédito'
      BandIndex = 0
      RowIndex = 0
      FieldName = 'totcred'
    end
    object dbgrd_renglonesTOTFON: TdxDBGridCurrencyColumn
      Caption = 'Total Fonacot'
      BandIndex = 0
      RowIndex = 0
      FieldName = 'totfon'
      SummaryFooterType = cstSum
      SummaryFooterField = 'COSTOTOT'
      SummaryFooterFormat = '$,0.00;-$,0.00'
    end
    object dbgrd_renglonestotfide: TdxDBGridCurrencyColumn
      Caption = 'Total Fide'
      BandIndex = 0
      RowIndex = 0
      FieldName = 'totfide'
    end
    object dbgrd_renglonestotimevi: TdxDBGridCurrencyColumn
      Caption = 'Total Imevi'
      BandIndex = 0
      RowIndex = 0
      FieldName = 'totimevi'
    end
    object dbgrd_renglonestotgral: TdxDBGridCurrencyColumn
      Caption = 'Total General'
      BandIndex = 0
      RowIndex = 0
      FieldName = 'totgral'
    end
  end
  object qry_analisma: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'select cast('#39#39' as varchar(10)) as llave,'
      'numero as zona, descri as nombrezon,'
      'cast('#39#39' as varchar(35)) as zonaacum,'
      'numero as linea, descri as descrilin,'
      '0 as totcont, 0 as totcred, 0 as totfon,'
      '0 as totfide, 0 as totimevi, 0 as totgral'
      'from lineas where numero = '#39'-1'#39)
    UpdateObject = uqry_gpodiary
    Left = 312
    Top = 200
  end
  object uqry_gpodiary: TUpdateSQL
    ModifySQL.Strings = (
      'update gpodiary'
      'set'
      '  DESCRI = :DESCRI,'
      '  IMPRIME = :IMPRIME'
      'where'
      '  IDGPODIARY = :OLD_IDGPODIARY')
    InsertSQL.Strings = (
      'insert into gpodiary'
      '  (IDGPODIARY, GRUPO, DESCRI, IMPRIME, CIA)'
      'values'
      '  (:IDGPODIARY, :GRUPO, :DESCRI, :IMPRIME, :CIA)')
    DeleteSQL.Strings = (
      'delete from gpodiary'
      'where'
      '  IDGPODIARY = :OLD_IDGPODIARY')
    Left = 342
    Top = 200
  end
  object dts_analisma: TDataSource
    AutoEdit = False
    DataSet = qry_analisma
    Left = 372
    Top = 200
  end
  object PopupMenu1: TPopupMenu
    Left = 256
    Top = 248
    object Exportara1: TMenuItem
      Action = exporta_dbgrd
    end
  end
  object ActionList1: TActionList
    Images = dm.ImageList1
    Left = 552
    Top = 280
    object exporta_dbgrd: TAction
      Caption = 'Exportar a...'
      ImageIndex = 19
      OnExecute = exporta_dbgrdExecute
    end
    object imprimir: TAction
      Caption = 'Imprimir'
      ImageIndex = 21
      OnExecute = imprimirExecute
    end
  end
  object qry_buscaventas: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'select e.zonainv, e.pvta, sum(d.costou)'
      'from entradas c join renentra d on c.tipo = d.tipo'
      'and c.alm = d.alm and c.numero = d.numero'
      'and c.cia = d.cia'
      'join inven a on d.codinv = a.codigo and d.cia = a.cia'
      'join ubivtainv e on d.alm = e.alm and d.recemi = e.pvta'
      'join inv_tpvtatmp f on c.tipo = f.tiposal'
      'where c.fecha between :FECINI and :FECFIN and c.cia = :CIA'
      'and f.idtarea = :IDTAREA'
      'group by e.zonainv, e.pvta'
      ''
      ' ')
    Left = 312
    Top = 248
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'FECINI'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'FECFIN'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'CIA'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'IDTAREA'
        ParamType = ptUnknown
      end>
  end
  object qry_datosventas: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'select e.zonainv, e.pvta, a.linea,'
      'sum(d.costou * (d.piva / 100 + 1 )) as costo'
      'from entradas c join renentra d on c.tipo = d.tipo'
      'and c.alm = d.alm and c.numero = d.numero'
      'and c.cia = d.cia'
      'join inven a on d.codinv = a.codigo and d.cia = c.cia'
      'join ubivtainv e on d.alm = e.alm and d.recemi = e.pvta'
      
        'where c.tipo = :TIPO and c.fecha between :FECINI and :FECFIN and' +
        ' c.cia = :CIA'
      'and d.folent between :FOLENTINI and :FOLENTFIN'
      'and zonainv = :ZONA and pvta = :PTOVTA and a.linea = :LINEA'
      'group by e.zonainv, e.pvta, a.linea'
      '')
    Left = 344
    Top = 248
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'TIPO'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'FECINI'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'FECFIN'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'CIA'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'FOLENTINI'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'FOLENTFIN'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'ZONA'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'PTOVTA'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'LINEA'
        ParamType = ptUnknown
      end>
  end
  object qry_lineas: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      
        'select numero, descri from lineas where cia = :CIA order by orde' +
        'n, numero')
    Left = 376
    Top = 248
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'CIA'
        ParamType = ptUnknown
      end>
  end
end
