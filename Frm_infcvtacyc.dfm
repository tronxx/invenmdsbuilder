object Form_infcvtacyc: TForm_infcvtacyc
  Left = 324
  Top = 131
  Width = 692
  Height = 480
  Caption = 'Informe de Costo de Venta Credito y Contado'
  Color = clBtnFace
  Font.Charset = DEFAULT_CHARSET
  Font.Color = clWindowText
  Font.Height = -11
  Font.Name = 'MS Sans Serif'
  Font.Style = []
  FormStyle = fsMDIChild
  OldCreateOrder = False
  Position = poDefault
  Visible = True
  OnClose = FormClose
  OnCreate = FormCreate
  PixelsPerInch = 96
  TextHeight = 13
  object Panel1: TPanel
    Left = 0
    Top = 0
    Width = 684
    Height = 89
    Align = alTop
    BevelOuter = bvNone
    TabOrder = 0
    object btn_imprel: TBitBtn
      Left = 582
      Top = 48
      Width = 77
      Height = 23
      Action = imprimir_reporte
      Caption = 'Reporte'
      TabOrder = 3
      Glyph.Data = {
        36040000424D3604000000000000360000002800000010000000100000000100
        2000000000000004000000000000000000000000000000000000FF00FF000000
        0000000000000000000000000000000000000000000000000000000000000000
        00000000000000000000000000000000000000000000FF00FF0000000000BFBF
        BF00BFBFBF00BFBFBF00BFBFBF00BFBFBF00BFBFBF00BFBFBF00BFBFBF00BFBF
        BF00BFBFBF00BFBFBF00BFBFBF00BFBFBF00BFBFBF000000000000000000BFBF
        BF00BFBFBF00BFBFBF00BFBFBF00BFBFBF00BFBFBF00BFBFBF00BFBFBF00BFBF
        BF00BFBFBF00BFBFBF00BFBFBF00BFBFBF00BFBFBF0000000000000000000000
        0000000000000000000000000000000000000000000000000000000000000000
        000000000000000000000000000000000000000000000000000000000000FFFF
        FF00BFBFBF00FFFFFF00BFBFBF00FFFFFF00BFBFBF00FFFFFF00BFBFBF00FFFF
        FF00BFBFBF00FFFFFF00BFBFBF00FFFFFF00BFBFBF000000000000000000BFBF
        BF00FFFFFF00BFBFBF00FFFFFF00BFBFBF00FFFFFF00BFBFBF00FFFFFF00BFBF
        BF00FFFFFF00BFBFBF00FFFFFF000000FF00FFFFFF000000000000000000FFFF
        FF00BFBFBF00FFFFFF00BFBFBF00FFFFFF00BFBFBF00FFFFFF00BFBFBF00FFFF
        FF00BFBFBF00FFFFFF00BFBFBF00FFFFFF00BFBFBF0000000000000000000000
        0000000000000000000000000000000000000000000000000000000000000000
        0000000000000000000000000000000000000000000000000000FF00FF00FF00
        FF00FF00FF0000000000FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
        FF00FFFFFF00FFFFFF0000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF0000000000FFFFFF0000000000000000000000000000000000FFFF
        FF0000000000FFFFFF0000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF0000000000FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFFFF00FFFF
        FF00FFFFFF00FFFFFF0000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF0000000000FFFFFF000000000000000000FFFFFF00000000000000
        0000000000000000000000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF0000000000FFFFFF00FFFFFF00FFFFFF00FFFFFF0000000000FFFF
        FF00FFFFFF0000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF0000000000FFFFFF0000000000BFBFBF00FFFFFF0000000000FFFF
        FF0000000000FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF0000000000FFFFFF00FFFFFF00FFFFFF00FFFFFF00000000000000
        0000FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00
        FF00FF00FF00000000000000000000000000000000000000000000000000FF00
        FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00FF00}
    end
    object pnl_datos: TGroupBox
      Left = 8
      Top = 1
      Width = 193
      Height = 80
      Caption = 'Fecha:'
      TabOrder = 0
      object lbl_vigencia: TLabel
        Left = 6
        Top = 18
        Width = 63
        Height = 13
        Caption = 'Fecha Inicial:'
      end
      object lbl_corte: TLabel
        Left = 7
        Top = 46
        Width = 58
        Height = 13
        Caption = 'Fecha Final:'
      end
      object date_ini: TDateTimePicker
        Left = 69
        Top = 14
        Width = 90
        Height = 22
        CalAlignment = dtaLeft
        Date = 38762.7111857986
        Time = 38762.7111857986
        DateFormat = dfShort
        DateMode = dmComboBox
        Kind = dtkDate
        ParseInput = False
        TabOrder = 0
        OnExit = date_iniExit
      end
      object date_fin: TDateTimePicker
        Left = 69
        Top = 41
        Width = 92
        Height = 22
        CalAlignment = dtaLeft
        Date = 38982.3491966782
        Time = 38982.3491966782
        DateFormat = dfShort
        DateMode = dmComboBox
        Kind = dtkDate
        ParseInput = False
        TabOrder = 1
      end
    end
    object GroupBox5: TGroupBox
      Left = 207
      Top = 1
      Width = 171
      Height = 80
      Caption = 'Reporte De:'
      TabOrder = 1
      object rbtn_fona: TRadioButton
        Left = 8
        Top = 38
        Width = 65
        Height = 17
        Caption = 'Fonacot'
        TabOrder = 1
      end
      object rbtn_imevi: TRadioButton
        Left = 97
        Top = 14
        Width = 50
        Height = 17
        Caption = 'Imevi'
        TabOrder = 3
      end
      object rbtn_fide: TRadioButton
        Left = 8
        Top = 57
        Width = 57
        Height = 17
        Caption = 'FIDE'
        TabOrder = 2
      end
      object rbtn_cel: TRadioButton
        Left = 96
        Top = 38
        Width = 57
        Height = 17
        Caption = 'Celular'
        TabOrder = 4
      end
      object rbtn_total: TRadioButton
        Left = 96
        Top = 57
        Width = 57
        Height = 17
        Caption = 'Total'
        Checked = True
        TabOrder = 5
        TabStop = True
      end
      object rbtn_menude: TRadioButton
        Left = 9
        Top = 14
        Width = 74
        Height = 17
        Caption = 'Menudeo'
        TabOrder = 0
        OnClick = rbtn_menudeClick
      end
    end
    object Group_venta: TGroupBox
      Left = 384
      Top = 1
      Width = 171
      Height = 80
      Caption = 'Desea Ventas De:'
      TabOrder = 2
    end
    object rbtn_conta: TRadioButton
      Left = 469
      Top = 20
      Width = 64
      Height = 17
      Caption = 'Contado'
      TabOrder = 4
    end
    object rbtn_credit: TRadioButton
      Left = 396
      Top = 20
      Width = 65
      Height = 17
      Caption = 'Credito'
      TabOrder = 5
    end
    object rbtn_totalv: TRadioButton
      Left = 396
      Top = 43
      Width = 57
      Height = 17
      Caption = 'Total'
      Checked = True
      TabOrder = 6
      TabStop = True
    end
  end
  object dbgrd_renglones: TdxDBGrid
    Left = 0
    Top = 89
    Width = 684
    Height = 357
    Bands = <
      item
      end>
    DefaultLayout = True
    HeaderPanelRowCount = 1
    KeyField = 'TIPO'
    ShowGroupPanel = True
    ShowSummaryFooter = True
    SummaryGroups = <>
    SummarySeparator = ', '
    Align = alClient
    TabOrder = 1
    DataSource = dts_armnar
    Filter.Active = True
    Filter.AutoDataSetFilter = True
    Filter.Criteria = {00000000}
    OptionsDB = [edgoCancelOnExit, edgoCanDelete, edgoCanInsert, edgoCanNavigation, edgoConfirmDelete, edgoLoadAllRecords, edgoUseBookmarks]
    OptionsView = [edgoAutoWidth, edgoBandHeaderWidth, edgoRowSelect, edgoUseBitmap]
    object dbgrd_renglonesZONA: TdxDBGridMaskColumn
      Caption = 'Num. Zona'
      Width = 98
      BandIndex = 0
      RowIndex = 0
      FieldName = 'ZONA'
    end
    object dbgrd_renglonesNOMZON: TdxDBGridMaskColumn
      Caption = ' Zona'
      Sorted = csUp
      Visible = False
      Width = 271
      BandIndex = 0
      RowIndex = 0
      FieldName = 'NOMZON'
      GroupIndex = 0
    end
    object dbgrd_renglonesPTVTA: TdxDBGridMaskColumn
      Caption = 'Punto'
      Width = 56
      BandIndex = 0
      RowIndex = 0
      FieldName = 'PTVTA'
    end
    object dbgrd_renglonesNOMPVTA: TdxDBGridMaskColumn
      Caption = 'Nombre de Punto Vta.'
      Width = 158
      BandIndex = 0
      RowIndex = 0
      FieldName = 'NOMPVTA'
    end
    object dbgrd_renglonesALMKDX: TdxDBGridMaskColumn
      Caption = 'Almacen'
      Width = 120
      BandIndex = 0
      RowIndex = 0
      FieldName = 'ALMKDX'
    end
    object dbgrd_renglonesVTASI: TdxDBGridMaskColumn
      Caption = 'Contado'
      Width = 116
      BandIndex = 0
      RowIndex = 0
      FieldName = 'VTASI'
    end
    object dbgrd_renglonesVTANO: TdxDBGridMaskColumn
      Caption = 'Credito'
      Width = 116
      BandIndex = 0
      RowIndex = 0
      FieldName = 'VTANO'
    end
  end
  object qry_max: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      
        'select max(idtpvtatmp) as max from inv_tpvtatmp where idtpvtatmp' +
        ' > 0')
    Left = 64
    Top = 190
  end
  object qry_delet: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'delete from inv_tpvtatmp where idtarea=:IDTAR')
    Left = 64
    Top = 254
    ParamData = <
      item
        DataType = ftInteger
        Name = 'IDTAR'
        ParamType = ptUnknown
      end>
  end
  object qry_maxidtar: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      
        'select max(idtarea) as idmax from inv_tpvtatmp where idtpvtatmp ' +
        '> 0')
    Left = 64
    Top = 224
  end
  object qry_tpvtatmp: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'select * from inv_tpvtatmp')
    UpdateObject = uqry_tpvtatmp
    Left = 64
    Top = 286
  end
  object uqry_tpvtatmp: TUpdateSQL
    ModifySQL.Strings = (
      'update inv_tpvtatmp'
      'set'
      '  IDTPVTATMP = :IDTPVTATMP,'
      '  IDTAREA = :IDTAREA,'
      '  IDTIPOVTA = :IDTIPOVTA,'
      '  FACTOR = :FACTOR,'
      '  TIPOSAL = :TIPOSAL,'
      '  FOLENTINI = :FOLENTINI,'
      '  FOLENTFIN = :FOLENTFIN'
      'where'
      '  IDTPVTATMP = :OLD_IDTPVTATMP')
    InsertSQL.Strings = (
      'insert into inv_tpvtatmp'
      '  (IDTPVTATMP, IDTAREA, IDTIPOVTA, FACTOR, TIPOSAL, FOLENTINI, '
      'FOLENTFIN)'
      'values'
      
        '  (:IDTPVTATMP, :IDTAREA, :IDTIPOVTA, :FACTOR, :TIPOSAL, :FOLENT' +
        'INI, '
      ':FOLENTFIN)')
    DeleteSQL.Strings = (
      'delete from inv_tpvtatmp'
      'where'
      '  IDTPVTATMP = :OLD_IDTPVTATMP')
    Left = 97
    Top = 287
  end
  object qry_deletinf: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'delete from infcvtatmp')
    Left = 176
    Top = 190
  end
  object qry_insert: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'insert into infcvtatmp (zona,ptvta,almkdx)'
      'select unique zonainv,pvta,alm from ubivtainv'
      ' ')
    Left = 176
    Top = 223
  end
  object qry_updateuno: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'update infcvtatmp set vtasi=0,vtano=0,cia= :CIA ,tipo='#39'1'#39
      #9'where tipo is null')
    Left = 176
    Top = 256
    ParamData = <
      item
        DataType = ftInteger
        Name = 'CIA'
        ParamType = ptUnknown
      end>
  end
  object qry_updatedos: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'update infcvtatmp set vtasi=0,vtano=0,cia= :CIA ,tipo='#39'2'#39
      #9'where tipo is null')
    Left = 176
    Top = 289
    ParamData = <
      item
        DataType = ftInteger
        Name = 'CIA'
        ParamType = ptUnknown
      end>
  end
  object qry_datos: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      
        'select a.*,b.nombre as nomzon,c.nombre as nompvta  from infcvtat' +
        'mp a'
      'join zonainv b on a.zona = b.zona'
      'join ptovta c on c.clave = a.ptvta'
      ' where a.cia= :CIA'
      ' order by a.tipo,a.zona,a.ptvta')
    Left = 296
    Top = 142
    ParamData = <
      item
        DataType = ftInteger
        Name = 'CIA'
        ParamType = ptUnknown
      end>
  end
  object qry_vtasi: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      
        'select sum(vtasi) as si from infcvtatmp where zona= :ZON and ptv' +
        'ta= :PTVTA'
      #9'and tipo= :TIPO and cia= :CIA')
    Left = 334
    Top = 142
    ParamData = <
      item
        DataType = ftString
        Name = 'ZON'
        ParamType = ptUnknown
      end
      item
        DataType = ftString
        Name = 'PTVTA'
        ParamType = ptUnknown
      end
      item
        DataType = ftString
        Name = 'TIPO'
        ParamType = ptUnknown
      end
      item
        DataType = ftInteger
        Name = 'CIA'
        ParamType = ptUnknown
      end>
  end
  object qry_vtano: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      
        'select sum(vtano) as no from infcvtatmp where zona= :ZON and ptv' +
        'ta= :PTVTA'
      #9'and tipo= :TIPO and cia= :CIA')
    Left = 372
    Top = 142
    ParamData = <
      item
        DataType = ftUnknown
        Name = 'ZON'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'PTVTA'
        ParamType = ptUnknown
      end
      item
        DataType = ftUnknown
        Name = 'TIPO'
        ParamType = ptUnknown
      end
      item
        DataType = ftInteger
        Name = 'CIA'
        ParamType = ptUnknown
      end>
  end
  object qry_armar: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'select * from infcvtatmp')
    Left = 296
    Top = 232
  end
  object qry_resul: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      
        'select d.factor, a.tipo, a.zona, a.ptvta, sum(a.ctovtasi + ivasi' +
        ') as vtasi,'
      'sum(ctovtano) as vtano,'
      'sum(a.ctovtasi + ivasi + ctovtano) as total'
      
        #9'from inv_tpvtatmp d join inv_tipovta e on d.idtipovta = e.idtip' +
        'ovta'
      #9'join tabcvta a on e.tiposal = a.tipoent'
      #9'where'
      #9'd.idtarea= :IDTAR'
      #9'and a.fecfin between :FECINI and :FECFIN'
      '        and fecini = convert_date('
      '     convert_char(Year(fecfin))+ '#39'-'#39' +'
      '     convert_char(Month(fecfin)) + '#39'-01'#39
      
        '    ) and fecfin =  timestampadd(4, -1, timestampadd(6, 1, fecin' +
        'i))'
      ''
      '    and a.cia= :CIA'
      '    group by'
      '    d.factor, a.tipo, a.zona, a.ptvta'
      '    order by d.factor desc, a.tipo, a.zona, a.ptvta'
      ''
      ' ')
    Left = 329
    Top = 232
    ParamData = <
      item
        DataType = ftInteger
        Name = 'IDTAR'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'FECINI'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'FECFIN'
        ParamType = ptUnknown
      end
      item
        DataType = ftInteger
        Name = 'CIA'
        ParamType = ptUnknown
      end>
  end
  object qry_upda: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      
        'update infcvtatmp set vtasi= :SI,vtano= :NO where ptvta= :PTVTA ' +
        'and almkdx= :ALM'
      #9'and tipo='#39'1'#39' and cia= :CIA')
    Left = 363
    Top = 232
    ParamData = <
      item
        DataType = ftFloat
        Name = 'SI'
        ParamType = ptUnknown
      end
      item
        DataType = ftFloat
        Name = 'NO'
        ParamType = ptUnknown
      end
      item
        DataType = ftString
        Name = 'PTVTA'
        ParamType = ptUnknown
      end
      item
        DataType = ftString
        Name = 'ALM'
        ParamType = ptUnknown
      end
      item
        DataType = ftInteger
        Name = 'CIA'
        ParamType = ptUnknown
      end>
  end
  object qry_limp: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'delete from infcvtatmp where vtasi=0 and vtano=0')
    Left = 395
    Top = 232
  end
  object qry_updatcan: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      
        'update infcvtatmp set vtasi= :SI,vtano= :NO where ptvta= :PTVTA ' +
        'and almkdx= :ALM'
      #9'and tipo='#39'2'#39' and cia= :CIA')
    Left = 363
    Top = 262
    ParamData = <
      item
        DataType = ftFloat
        Name = 'SI'
        ParamType = ptUnknown
      end
      item
        DataType = ftFloat
        Name = 'NO'
        ParamType = ptUnknown
      end
      item
        DataType = ftString
        Name = 'PTVTA'
        ParamType = ptUnknown
      end
      item
        DataType = ftString
        Name = 'ALM'
        ParamType = ptUnknown
      end
      item
        DataType = ftInteger
        Name = 'CIA'
        ParamType = ptUnknown
      end>
  end
  object dts_armnar: TDataSource
    DataSet = qry_datos
    Left = 296
    Top = 176
  end
  object ActionList1: TActionList
    Images = dm.ImageList1
    Left = 568
    Top = 176
    object imprimir_reporte: TAction
      Caption = 'Reporte'
      ImageIndex = 21
      OnExecute = imprimir_reporteExecute
    end
  end
  object qry_acumxzona: TQuery
    CachedUpdates = True
    DatabaseName = 'manvehi'
    Filtered = True
    SQL.Strings = (
      'select c.zonaptvta as zona, sum(a.ctovtasi + ivasi) as vtasi,'
      'sum(ctovtano) as vtano,'
      'sum(a.ctovtasi + ivasi + ctovtano) as total'
      
        #9'from inv_tpvtatmp d join inv_tipovta e on d.idtipovta = e.idtip' +
        'ovta'
      #9'join tabcvta a on e.tiposal = a.tipoent'
      #9'join ubivtainv c on a.ptvta = c.pvta and c.alm = '#39#39
      #9'where'
      #9'd.idtarea= :IDTAR'
      #9'and a.fecfin between :FECINI and :FECFIN'
      '        and fecini = convert_date('
      '     convert_char(Year(fecfin))+ '#39'-'#39' +'
      '     convert_char(Month(fecfin)) + '#39'-01'#39
      
        '    ) and fecfin =  timestampadd(4, -1, timestampadd(6, 1, fecin' +
        'i))'
      ''
      '    and a.cia= :CIA'
      '    group by c.zonaptvta'
      '')
    Left = 329
    Top = 264
    ParamData = <
      item
        DataType = ftInteger
        Name = 'IDTAR'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'FECINI'
        ParamType = ptUnknown
      end
      item
        DataType = ftDateTime
        Name = 'FECFIN'
        ParamType = ptUnknown
      end
      item
        DataType = ftInteger
        Name = 'CIA'
        ParamType = ptUnknown
      end>
  end
end
